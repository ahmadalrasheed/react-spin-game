{"version":3,"file":"index.umd.js","sources":["../src/react-spin-game.tsx"],"sourcesContent":["import React, {\n  useRef,\n  useState,\n  useLayoutEffect,\n  forwardRef,\n  useImperativeHandle\n} from 'react'\nimport { ReactComponent as Arrow } from './Images/wheel-arrow.svg'\nimport Styles from './styles.module.css'\n\n\ninterface SpinGameData {\n  data: Array<Array<string>>\n  hideButton?: boolean\n  result?: string\n  time?: number\n  minTime?: number\n  maxTime?: number\n  removeButtonEffect?: boolean\n  fontSize?: number\n  fontFamily?: string\n  horizantalText?: boolean\n}\n\nconst SpinAndWin = forwardRef(\n  (\n    {\n      data,\n      hideButton,\n      result,\n      time,\n      minTime,\n      maxTime,\n      removeButtonEffect,\n      fontSize,\n      fontFamily,\n      horizantalText,\n    }: SpinGameData,\n    ref\n  ) => {\n    interface stateInfo {\n      winnerAngle: number\n    }\n    const wheelRef = useRef<any>()\n    const [state] = useState<stateInfo>({ winnerAngle: 0 })\n    useLayoutEffect(() => {\n      var wheelCanvas = document.getElementById('wheel')\n      if (wheelCanvas && isCanvas(wheelCanvas)) {\n        var wheel = wheelCanvas.getContext('2d')\n        var wheelX = wheelCanvas.width / 2\n        var wheelY = wheelCanvas.height / 2\n        var wheelRadius = Math.min(wheelX, wheelY)\n\n        drawWheel(data, wheel, wheelX, wheelY, wheelRadius)\n      }\n    }, [])\n    function isCanvas(\n      obj: HTMLCanvasElement | HTMLElement\n    ): obj is HTMLCanvasElement {\n      return obj.tagName === 'CANVAS'\n    }\n    const degToRad = (deg: number) => {\n      return (deg * Math.PI) / 180.0\n    }\n    const drawWheel = (\n      list: Array<Array<string>>,\n      wheel: any,\n      wheelX: number,\n      wheelY: number,\n      wheelRadius: number\n    ) => {\n      var segment = 360 / list.length\n\n      list.map((el: Array<string>, i: number) => {\n        wheel.save()\n        wheel.translate(wheelX, wheelY)\n        wheel.rotate(degToRad(segment * i))\n        wheel.translate(-wheelX, -wheelY)\n\n        wheel.fillStyle = el[1] ? el[1] : 'red'\n\n        wheel.beginPath()\n        wheel.moveTo(wheelX, wheelY)\n        wheel.arc(\n          wheelX,\n          wheelY,\n          wheelRadius,\n          0 - degToRad(90) - degToRad(segment / 2),\n          degToRad(segment) - degToRad(90) - degToRad(segment / 2),\n          false\n        )\n        wheel.moveTo(wheelX, wheelY)\n        wheel.fill()\n\n        wheel.fillStyle = 'white'\n        horizantalText ? (wheel.textAlign = 'start') : (wheel.textAlign = 'end')\n        wheel.font =\n          fontSize && fontFamily\n            ? `${fontSize}px ${fontFamily}`\n            : fontSize\n            ? `${fontSize}px sans-serif`\n            : fontFamily\n            ? `18px ${fontFamily}`\n            : '18px sans-serif'\n        wheel.transform = 'translate(50px, 100px)'\n        if (horizantalText) {\n          wheel.textAlign = 'center'\n          wheel.fillText(el[0], wheelX, wheelY / 4)\n        } else {\n          wheel.rotate(-1.57)\n          wheel.fillText(el[0], -20, wheelY + 10)\n        }\n\n        wheel.restore()\n      })\n    }\n    useImperativeHandle(ref, () => ({\n      handleSpin() {\n        let wheelCanvas = document.getElementById('wheel')\n        if (wheelCanvas) {\n          const freeSpinResult = result ? result : '23454'\n          let transitionTime = time\n            ? time\n            : minTime && maxTime && minTime > 0 && maxTime > 0\n            ? Math.floor(Math.random() * (maxTime - minTime + 1)) + minTime\n            : Math.floor(Math.random() * (4 - 3 + 1)) + 3\n          wheelCanvas.style.transition = transitionTime + 's'\n\n          let winner = data.find((item: Array<string>) => {\n            return item[0] === freeSpinResult\n          })\n          if (!winner) {\n            winner = ['']\n          }\n          let freeSpinGifts: Array<string> = []\n          data.map((item: Array<string>) => {\n            freeSpinGifts.push(item[0])\n          })\n          let winnerIndex = freeSpinGifts.indexOf(winner[0])\n          let offset = state.winnerAngle % 360\n          state.winnerAngle =\n            state.winnerAngle +\n            1800 -\n            (360 * winnerIndex) / freeSpinGifts.length -\n            offset\n          let deg = 'rotate(' + state.winnerAngle + 'deg)'\n          wheelCanvas.style.transform = deg\n        }\n      }\n    }))\n    const handleSpin = () => {\n      let wheelCanvas = document.getElementById('wheel')\n      if (wheelCanvas) {\n        const freeSpinResult = result ? result : '23454'\n        let transitionTime = time\n          ? time\n          : minTime && maxTime && minTime > 0 && maxTime > 0\n          ? Math.floor(Math.random() * (maxTime - minTime + 1)) + minTime\n          : Math.floor(Math.random() * (4 - 3 + 1)) + 3\n        wheelCanvas.style.transition = transitionTime + 's'\n\n        let winner = data.find((item: Array<string>) => {\n          return item[0] === freeSpinResult\n        })\n        if (!winner) {\n          winner = ['']\n        }\n        let freeSpinGifts: Array<string> = []\n        data.map((item: Array<string>) => {\n          freeSpinGifts.push(item[0])\n        })\n        let winnerIndex = freeSpinGifts.indexOf(winner[0])\n        let offset = state.winnerAngle % 360\n        state.winnerAngle =\n          state.winnerAngle +\n          2520 -\n          (360 * winnerIndex) / freeSpinGifts.length -\n          offset\n        let deg = 'rotate(' + state.winnerAngle + 'deg)'\n        wheelCanvas.style.transform = deg\n      }\n    }\n    return (\n      <div>\n        <div className={Styles['rewards-spin-game']}>\n          <div className={Styles['canvas-container']}>\n            <canvas\n              ref={wheelRef}\n              id=\"wheel\"\n              className={Styles['wheel']}\n              width='450px'\n              height='450px'\n            />\n            {!hideButton && (\n              <span\n                className={Styles['spin']}\n                onClick={() => (removeButtonEffect ? '' : handleSpin())}\n              >\n                SPIN\n              </span>\n            )}\n          </div>\n          <span className={Styles['arrow']}>\n            <Arrow />\n          </span>\n        </div>\n      </div>\n    )\n  }\n)\n\nexport default SpinAndWin\n"],"names":["SpinAndWin","forwardRef","ref","data","hideButton","result","time","minTime","maxTime","removeButtonEffect","fontSize","fontFamily","horizantalText","wheelRef","useRef","useState","winnerAngle","state","useLayoutEffect","wheelCanvas","document","getElementById","isCanvas","wheel","getContext","wheelX","width","wheelY","height","wheelRadius","Math","min","drawWheel","obj","tagName","degToRad","deg","PI","list","segment","length","map","el","i","save","translate","rotate","fillStyle","beginPath","moveTo","arc","fill","textAlign","font","transform","fillText","restore","useImperativeHandle","handleSpin","freeSpinResult","transitionTime","floor","random","style","transition","winner","find","item","freeSpinGifts","push","winnerIndex","indexOf","offset","React","className","Styles","id","onClick","Arrow"],"mappings":"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"}